---
id: oauth2-grant-type-jwt-bearer-profile
title: JSON Web Token (JWT) Profile (RFC7523)
---

Ory Hydra is capable of performing the
[JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants](https://tools.ietf.org/html/rfc7523).

## OAuth 2.0 Client Authentication with JSON Web Token Profile

ORY Hydra supports OAuth 2.0 Client Authentication with RSA and ECDSA
private/public keypairs with currently supported signing algorithms:

- RS256 (default), RS384, RS512
- PS256, PS384, PS512
- ES256, ES384, ES512

This authentication method replaces the classic HTTP Basic Authorization and
HTTP POST Authorization schemes. Instead of sending the `client_id` and
`client_secret`, you authenticate the client with a signed JSON Web Token.

To enable this feature for a specific OAuth 2.0 Client, you must set
`token_endpoint_auth_method` to `private_key_jwt` and register the public key of
the RSA/ECDSA signing key either using the `jwks_uri` or `jwks` fields of the
client.

When authenticating the client at the token endpoint, you generate and sign
(with the RSA/ECDSA private key) a JSON Web Token with the following claims:

- `iss`: REQUIRED. Issuer. This MUST contain the client_id of the OAuth Client.
- `sub`: REQUIRED. Subject. This MUST contain the client_id of the OAuth Client.
- `aud`: REQUIRED. Audience. The aud (audience) Claim. Value that identifies the
  Authorization Server (ORY Hydra) as an intended audience. The Authorization
  Server MUST verify that it is an intended audience for the token. The Audience
  SHOULD be the URL of the Authorization Server's Token Endpoint.
- `jti`: REQUIRED. JWT ID. A unique identifier for the token, which can be used
  to prevent reuse of the token. These tokens MUST only be used once, unless
  conditions for reuse were negotiated between the parties; any such negotiation
  is beyond the scope of this specification.
- `exp`: REQUIRED. Expiration time on or after which the ID Token MUST NOT be
  accepted for processing.
- `iat`: OPTIONAL. Time at which the JWT was issued.

When making a request to the `/oauth2/token` endpoint, you include
`client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer`
and `client_assertion=<signed-jwt>` in the request body:

```
POST /oauth2/token HTTP/1.1
Host: my-hydra.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&
code=i1WsRn1uB1&
client_id=s6BhdRkqt3&
client_assertion_type=
urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&
client_assertion=PHNhbWxwOl ... ZT
```

Here's what a client with a `jwks` containing one RSA public key looks like:

```json
{
  "client_id": "rsa-client-jwks",
  "jwks": {
    "keys": [
      {
        "kty": "RSA",
        "n": "jL7h5wc-yeMUsHGJHc0xe9SbTdaLKXMHvcIHQck20Ji7SvrHPdTDQTvZtTDS_wJYbeShcCrliHvbJRSZhtEe0mPJpyWg3O_HkKy6_SyHepLK-_BR7HfcXYB6pVJCG3BW-lVMY7gl5sULFA74kNZH50h8hdmyWC9JgOHn0n3YLdaxSWlhctuwNPSwqwzY4qtN7_CZub81SXWpKiwj4UpyB10b8rM8qn35FS1hfsaFCVi0gQpd4vFDgFyqqpmiwq8oMr8RZ2mf0NMKCP3RXnMhy9Yq8O7lgG2t6g1g9noWbzZDUZNc54tv4WGFJ_rJZRz0jE_GR6v5sdqsDTdjFquPlQ",
        "e": "AQAB",
        "use": "sig",
        "kid": "rsa-jwk"
      }
    ]
  },
  "token_endpoint_auth_method": "private_key_jwt",
  "token_endpoint_auth_signing_alg": "RS256"
}
```

And here is how it looks like for a `jwks` including an ECDSA public key:

```json
{
  "client_id": "ecdsa-client-jwks",
  "jwks": {
    "keys": [
      {
        "kty": "EC",
        "use": "sig",
        "crv": "P-256",
        "kid": "ecdsa-jwk",
        "x": "nQjdhpecjZRlworpYk_TJAQBe4QbS8IwHY1DWkfR0w0",
        "y": "UQfLzHxhc4i3EETUeaAS1vDVFJ-Y01hIESiXqqS86Vc"
      }
    ]
  },
  "token_endpoint_auth_method": "private_key_jwt",
  "token_endpoint_auth_signing_alg": "ES256"
}
```

And with `jwks_uri`:

```json
{
  "client_id": "client-jwks-uri",
  "jwks_uri": "http://path-to-my-public/keys.json",
  "token_endpoint_auth_method": "private_key_jwt",
  "token_endpoint_auth_signing_alg": "RS256"
}
```

The `jwks_uri` must return a JSON object containing the public keys associated
with the OAuth 2.0 Client:

```json
{
  "keys": [
    {
      "kty": "RSA",
      "n": "jL7h5wc-yeMUsHGJHc0xe9SbTdaLKXMHvcIHQck20Ji7SvrHPdTDQTvZtTDS_wJYbeShcCrliHvbJRSZhtEe0mPJpyWg3O_HkKy6_SyHepLK-_BR7HfcXYB6pVJCG3BW-lVMY7gl5sULFA74kNZH50h8hdmyWC9JgOHn0n3YLdaxSWlhctuwNPSwqwzY4qtN7_CZub81SXWpKiwj4UpyB10b8rM8qn35FS1hfsaFCVi0gQpd4vFDgFyqqpmiwq8oMr8RZ2mf0NMKCP3RXnMhy9Yq8O7lgG2t6g1g9noWbzZDUZNc54tv4WGFJ_rJZRz0jE_GR6v5sdqsDTdjFquPlQ",
      "e": "AQAB",
      "use": "sig",
      "kid": "rsa-jwk"
    }
  ]
}
```

## JWT Authorization Grant

Ory Hydra supports issuing access tokens by trading in a JSON Web Token when
performing a request at the OAuth2 Token Endpoint. The value of the `grant_type`
is `urn:ietf:params:oauth:grant-type:jwt-bearer`.

```
POST /oauth2/token HTTP/1.1
Host: hydra.ory
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
&assertion=eyJhbGciOiJFUzI1NiIsImtpZCI6IjE2In0.
eyJpc3Mi[...omitted for brevity...].
J9l-ZhwP[...omitted for brevity...]
```

The JSON Web Token must be signed using a cryptographic key which you need to
register at the `/grants/jwt-bearer` endpoint before. The issuer and the subject
must also be explicitly allowed at that endpoint Additionally, the following
rules apply:

1. The JWT MUST contain an `iss` (issuer) claim that contains a unique
   identifier for the entity that issued the JWT. The value is compared using a
   simple string comparison!
2. The JWT MUST contain a "sub" (subject) claim identifying the principal that
   is the subject of the JWT. The subject identifies an authorized accessor for
   which the access token is being requested (i.e., the resource owner or an
   authorized delegate - the `sub` of the access token which will be issued),
   but in some cases, may be a pseudonymous identifier or other value denoting
   an anonymous user.
3. The JWT MUST contain an `aud` (audience) claim containing a value that
   identifies the authorization server as an intended audience. The token
   endpoint URL of the authorization server MAY be used as a value for an "aud"
   element to identify the authorization server as an intended audience of the
   JWT. The authorization server MUST reject any JWT that does not contain its
   own identity as the intended audience.
4. The JWT MUST contain an `exp` (expiration time) claim that limits the time
   window during which the JWT can be used. The authorization server MUST reject
   any JWT with an expiration time that has passed, subject to allowable clock
   skew between systems. Note that the authorization server may reject JWTs with
   an `exp` claim value that is unreasonably far in the future.
5. The JWT MAY contain an "nbf" (not before) claim that identifies the time
   before which the token MUST NOT be accepted for processing.
6. The JWT MAY contain an "iat" (issued at) claim that identifies the time at
   which the JWT was issued. Note that the authorization server may reject JWTs
   with an "iat" claim value that is unreasonably far in the past.
7. The JWT MAY contain a "jti" (JWT ID) claim that provides a unique identifier
   for the token. The authorization server MAY ensure that JWTs are not replayed
   by maintaining the set of used "jti" values for the length of time for which
   the JWT would be considered valid based on the applicable "exp" instant.

The JWT body may look like:

```json
{
  "iss": "https://jwt-idp.example.com",
  "sub": "mailto:mike@example.com",
  "aud": "https://jwt-rp.example.net",
  "nbf": 1300815780,
  "exp": 1300819380,
  "http://claims.example.com/member": true
}
```

### Performing the JSON Web Token (JWT) Profile for OAuth 2.0 Client Authorization Grants

KeyOAuth2GrantJWTClientAuthOptional = "oauth2.grant.jwt.client_auth_optional"
KeyOAuth2GrantJWTIDOptional = "oauth2.grant.jwt.jti_optional"
KeyOAuth2GrantJWTIssuedDateOptional = "oauth2.grant.jwt.iat_optional"
KeyOAuth2GrantJWTMaxDuration = "oauth2.grant.jwt.max_ttl"
